workspace: true

stages:
  - build

jobs:
- name: Build
  stage: build
  image: androidsdk/android-29:latest
  environment:
    JVM_OPTS: -Xmx3200m
      # This is Android review pull request box (Not necessary to change)
      ROOM_ID: "123456789"
      # Insert the chatwork accounts which you want to mention when the pull request was verified
      MEMBERS: "[To:1234567] Tran Quang Huy"
  cache:
  - key: jars-{{ checksum "build.gradle" }}-{{ checksum  "app/build.gradle" }}
    paths:
      - .gradle
  before_script:
  - echo "Start job"
  - chmod +x ./gradlew
  script:
  - ./gradlew androidDependencies
  - ./gradlew lint test
  artifacts:
      paths:
        - app/build/reports
        - app/build/test-results
      expires_in: 3 days
  after_script:
  - echo "Finish job"
  only:
    branches:
    - develop
    - main
    events:
    - pull_request
